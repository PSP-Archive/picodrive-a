
================================================
  ＰＳＰ開発幼稚園  http://ameblo.jp/pspdevblog/  （本館）（ブログ）
  ＰＳＰ開発幼稚園  http://psp.nukenin.jp/        （別館）（ＨＰ）
================================================

■ナメック星の技術でもう少し速くなった。が、アイコンが肌色になった。
■「slapfight」とか「starcruser」とか動かないんですケド、ナメック星人は遊ばないのか？
■標準11025→22050に変更。
■固定ＦＰＳ廃止。SEGADRIVE(DGEN100)式の、ＡｕｔｏＦＰＳになった。
（間に合えば、設定値より速い値で自動動作する）

「m22z05EBOOT.PBP」594kB (？)
「m44z05EBOOT.PBP」582kB (？)

====================================================
これは正規版ではありません。「pico drive A14」
（２００６－０８／０１、１２：００版）
ソース学習用です。ＧＰＬ２です。
原作者と私は無関係です。

原作者に問い合わせる事はやめて下さい。
====================================================

■Ｚ８０フュージョン（融合）成功。Z11+Z22=Z03になった。
ちなみにこのＺ８０、SEGADRIVEA31で同じの使う。
■ＧＣＣ４００⇒ＧＣＣ４０２もどきになった。詳しくは本館。
■ちびっとダケ速くなった。（よーな気がする）
■「turbo-outrun」で画面がバグるよーになった。（原因ワカンナイ？）

「m22z03EBOOT.PBP」710kB (微妙に軽い？)
「m33z03EBOOT.PBP」668kB (m22+より不安定？)

====================================================

「ソニック２」、「ソニック３」は動かなくなった。
で、今回から「不思議ちゃん２」は動く。
「ぷよぷよ２」も（ちゃんと）動く！！（ウッソ～ん、何でぇ？）


■「ＡｕｔｏＦＰＳ標準にした」が、なーーんかバグっぽい。まあいいや。そのうち
何とかなるに違いない。っていうかなるといいなあ。

■「残像」が無くなって、遊べるエミュにはなっている。（もちろん遅いが）

■ＭＡＭＥ１０６ｓから盗んできたＺ８０にしてみた。
えっと従来のをカイリョー（カイゾー）したのが、Ｚ１１、
ＭＡＭＥ１０６ｓのがＺ２２。（ちなみに１０６ｓのリリースは今年の５月だにょ）
うーん、どっちが速いやら？あまり差がない。っていうかこのエミュ。
ＦＰＳ表示は、ちょっと違うし（値が変だし）、確認しようが無いってのがゲンジョーだったり...
（でもタブンＺ１１のが軽い気がする？？）
で、４種類。

「m22z11EBOOT.PBP」831kB （これが軽いんじゃないのかな？ワカラン）
「m22z22EBOOT.PBP」828kB 上と大差ない。（これも軽いかも？）

「m33z11EBOOT.PBP」782kB （スタークルーザー、ソーサリアン用）
「m33z22EBOOT.PBP」779kB 上と大差ない。（スタークルーザーとか用？でもチッチャイと軽い可能性が...）

■今回「ソニック２とか３とか」が巧く動かなくなっちゃったんで、「ＩＭ２モード」を外した。
再実装するなら「違う方式」で「再実装」する。が、そんな話は「先の話」しばらくは（予定が）無い。

あ、「ＩＭ２モード」ってのは「ソニック２」とか「ソニック３」とかの２画面分割で使ってるあれ。
「インターレースモード２」って名前。（タブン誰かが勝手に名前を付けた）

「ＤＧＥＮ」や「ＳＥＧＡＤＲＩＶＥ」では「インターレースにならない」が、再現する。っていうか、
仮に６０ｆｐｓで動いたとして、「ＰＳＰでインターレースが必要か擬問」。違う方式で再実装すれば、
「インターレースが付いても大して重い処理ではない」と思うが、「マダやってないから妄想」ではある。
（「旧picodriveA11」ではインターレース付で再現する。が、６０ｆｐｓで動かないから意味は無い）
（ＩＭ２モードは６０ｆｐｓで動かない限り、ゲームがやりにくくなるダケなんで意味不明。つまり無駄）

■操作関連を変えた。つまり「ＳＥＧＡＤＲＩＶＥ互換」にした。
えっと、「Ｌ＋Ｒ」でメニュー。とＧＡＭＥを往復出来る。従来の「△＋Ｌ＋Ｒでリセット」も使える。
「SELECT」と「START」でもメニューに戻れる。（一応）

でも、「１ｘ」の場合は使えない。（っていうか役目が違う）

■自動修正機能はウザイから標準はＯＦＦにした。

■保存は出来ないが標準の設定（ＲＯＭ読むと、「１ｘ以外は」標準の設定になる）を変えられる。よーになった。

■説明疲れたから、とにかく使ってみてよ。

それから、「HOME終了」出来るのに、エミュが止まる場合がある。（設定画面に行けない）
これはＰＳＰは実は死んでない。（変なメモリに書いたりしてない。）
（註：変なメモリに書くとＯＳの世話になって、１０秒くらいで強制終了される）
タブン「ＡｕｔｏＦＰＳの不具合」らしい。（多分ＡＵＴＯ値が変な数値になってる）
つまりバグ。原因はワカンナイ。（今回のＡｕｔｏＦＰＳの実装は結構アヤシー）
（「エミュ本体」が本当に死んで、「音楽が鳴りっぱなし」になる事は現状、殆どアリエないです。）

うまくやるとそのまま回復出来る場合がある（Ｌ＋Ｒひたすら押しっぱなし）が、
素直に「HOME終了」した方が速い。


================================================
以下はまだらに辻褄が合ってない気がする...
================================================

■自動修正機能（意味が判らないなら「Ｘボタン」＝＝「いいえ」を押して下さい）
自動修正してしまうと立ち上がらなくなるＲＯＭ。
（他にもあります。ＢＩＮ形式で２ＭＢytes以上の物が対象です。）

「ダイナマイト、ヘッディー」
「ファンタシースターⅡ」
「サンダーフォースⅣ」

これらは、もしかして「バンク切り替えで（？？？）、チェックの方法が通常と違う」可能性があります。
現在情報収集中で、まだ詳細が良く判らないです。

□普通は、何も考えず「Ｘボタン」＝＝「いいえ」でＯＫです。
「○ボタン」＝＝「はい」は特殊機能です。

================================================
「Ｌ＋Ｒキー」か[SELECT]キーか、[START]キーが、メニュー。
（「Ｌ＋Ｒキー」なら、ゲームと設定を行き来出来る。）

Ｌキーか、Ｒキーで連射。（設定値０が対連射装置対策用、不定期連射）

メニューで、ＬキーかＲキー押せば、ファイラーと設定画面の切り替え。

設定画面の[RESET]はキャンセルなど、無いからそのつもりで。

（註：不定期連射って何？要するに「パノラマコットン」用なんだけど、役に立つか微妙）
================================================

■管理人、一時期メガドラ狂いだった為。（今でもそうかも）
国内で発売されたＲＯＭに関しては、ほぼ（スポーツ等を除く）
８割方は、持ってます。ので動作確認は可能です。
（確か２５０本ぐらいです。数えてない。
いやもっとあるな、理性が数えるなと言うもので。
カードリッジだけにして、大体みかん箱２つ分くらい。
メガドラというだけで無条件に購入してたもので。）

でも、「６ボタンパッド」を持っていない為、
有名なのに「ストⅡ’」は持ってません。
他にも「無い」ものも沢山ある。
「ガントレット」とか。「テトリス」とか。

■メガドラはマッパーがないから、吸出し機を自作すれば吸出しは簡単です。

■現在動作確認は殆どやってません。

■動作の確認をしたＲＯＭ。
「ダイナマイト、ヘッディー」
「サンダーフォースⅢ」
「サンダーフォースⅣ」（ＦＳＫＩＰ１でね）
「ダライアスⅡ」
「スラップファイト」

「バーニングフォース」
「デンジャラスシード」（何故か多少重い）
「ローリングサンダー２」

「アウトラン」
「アウトラン２０１９」
「ターボアウトラン」

「パノラマコットン」（画面多少バグる）
「スーパーファンタジーゾーン」

その他、書くのが疲れるので、この辺で。
でも、大抵動くと思います。


//この辺はこのエミュの話ではない。（吸出しに特別苦労した奴）
//■現物の状態が悪くて吸出し失敗したＲＯＭ。（未チェック）
//「マーベルランド」（パッチ当てまくって動くんだけど、
//下の三つのランクはエンディングまで動作確認したけど、一番上のランクがまだ）
//「大魔界村」（Ｚ８０がバグるのでパッチを当てた。がちゃんと吸い出せてるのかも？）
//■正常に吸い出せたか、いまいち未確認なＲＯＭ。
//「Ｔｈｏｒ」（もちろん日本版ですよ）
//■動作はするがエミュではパッチを当てた方がいいと思うＲＯＭ。（未チェック）
//「スーパーハイドライド（ハイドライド３）」（ＳＲＡＭサイズ）
//関係ないけど「ＭＷ３」のメモリは何？（ＳＲＡＭではない。シリアルＳＲＡＭ？？）

■動作しないＲＯＭ。
「ソニック２」の２分割。
「ソニック３」の２分割。
ｍ２２＋版は「スタークルーザー」が動かん。
ｍ３３＋版は「インセクターＸ」が動かん。

■動作しないと報告があったＲＯＭ。
「スパⅡ」（起動しないらしい）（pspＤＧＥＮ１.６０で動作するそうです。マダ未確認ですが）

■動作するらしいＲＯＭ。
「ダブルドラゴン」（海外版？）
「ダブルドラゴン２」

■対応自体が無茶だと思うＲＯＭ。（特殊チップ）
「ＶＲ」（吸い出してない、っていうか分解して、直接半田付け
しなきゃ吸いだせん！しかも吸い出しても意味がない）
「メガＣＤ専用バックアップＲＡＭカートリッジ」
（えーだって「本製品はゲームではありません」って書いてあるし）

■関係ないけど、管理人のＲＯＭは大抵改造してあります。
（もちろん現物のイメージは取ってある）だってメガドラのゲームって
ムズイし、カクシコマンドは複雑なんだもん。（そんなもん覚えられるか）
安直なパッチ当てではなくって、場合によっては、本格的にプログラム
ルーチンを作ったり。（テストモードとか）元のプログラムが大抵タコ（失礼）
だから周辺を最適化して隙間を作って埋め込む。

================================================
現状はサウンドは、いまいちバグっぽいですな。
ＤＡＣはまだ作ってません。
================================================
以下は校正中です。辻褄合わなくても、知らんもんね。
（それに、仕様変わる予定だし...）




詳しくは本館へ。

■そうそう、実験ですから、ｍ６８０００を換えたＥＢＯＯＴ.ＰＢＰが、両方入ってる事があります。

■「EBOOT##.PBP」は、「EBOOT.PBP」にリネームして使用してください。

□ＭＵＳＡＳＩ２．０Ａ改、ベース。（通称Ｍ２２＋版）
「EBOOT22.PBP」→「EBOOT.PBP」（速い）

□ＭＵＳＡＳＩ３．３改、ベース。（通称Ｍ３３＋版）
「EBOOT33.PBP」→「EBOOT.PBP」（多少遅い）

■
src/mpu33/「ＭＵＳＡＳＩ３．３（多少古いＶＥＲですので、クロックにバグ有り）」（通称Ｍ３３＋版）
src/mpu/「ＭＵＳＡＳＩ２．０Ａ（を、わたしが少し３３風にした奴）」（通称Ｍ２２＋版）
（動作が少し、速くなるから、変更してみた）
ディレクトリ名を変えてコンパイルすると他のＭＰＵ版が生成。
お急ぎの方はどおぞ。

■（ＺＩＰ＆ＢＩＮ）読み込み、不安定すぎですぅ。
初めの一っ回さえ切り抜ければ、絶対に失敗しないのに。
失敗したら、違うＲＯＭを読む方が成功率が高いです。


結構速くなってきたな。早く使えるエミュに成長してね。

================================================
■起動して、一番始めのＲＯＭは上手く読まない場合があります。（バグ）
そうなってしまった場合は、電源スイッチ、長押しでお願いします。
================================================
■ゲーム画面で[HOME]終了すると、いつまでたっても終了できない
場合があります。（Ｌキーを押し、ファイラー画面で終了して下さい。これもバグ）
そうなってしまった場合は、電源スイッチ、長押しでお願いします。
================================================
■三回やっても起動しない場合は、ダミーで、他のＲＯＭを読ませて、
下さい。立ち上がったら。目的のＲＯＭを読ませます。
（一連のバグは多分同じ原因だけど、わかんねー）
================================================
□ゲーム中操作方法。
注意：スタート、Ａ、Ｂ、Ｃの配置は変える予定がないです。っていうか、
位置を入れ替えちゃうと、ソーサリアンも、ＭＷ３も解けないよ。
それにＭＤは、スタートが手元にないと不便で仕方がない。
（そういう風にソフトが作ってあるから）
（６ボタンのソフトはまだ未対応です。）

Ｌ＋Ｒキー：メニューへ戻る
Ｌキー：連射                    Ｒキー：連射
            ____________________________________                
           |                                    |     スタート  
           |                                    |     ｜        
           |      （＝'  ＝＝  ＝＝   /X        |     △        
方向≡方向 |        ＝   ＝－（  ＝  /  X       | □      ○    
           |       .＝） ＝＝  ＝＝ /    X      | ｜  ×  ｜    
           |                                    | ｜  ｜  ｜    
  （＠）   |                                    | Ａ  Ｂ  Ｃ    
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
[SELECT]キー：メニューへ戻る    [START]キー： メニューへ戻る

■特殊操作：ＭＤリセット。
 △（メガドラのスタート）＋Ｌキー＋Ｒキーで、メガドラをリセット。
この方法でリセットすると、「ＦＳＫＩＰ」、「画面モード」、「サウンドレート」、「連射」の
設定値が初期値になります。

■注意：画面モードを変更して、小さい原寸画面になった時だけ、
操作方法が変わります。（詳しくは下記、ミニメニュー中操作）

■アナログキーも使ってね。

================================================
□ファイラー中操作（必ずファイラー画面か設定画面で[HOME]終了して下さい）

Ｌ＋Ｒキー：ゲームへ戻る

Ｌキー：設定画面へ移動                   Ｒキー：設定画面へ移動

    △―――上のフォルダへ移動
□      ○
    ×  ｜
    ｜  ｜
    ｜  決定／ロード（下のフォルダへ移動／カートリッジ読み込み）
    ｜      
    キャンセル（ゲームに戻ります）
================================================
□ミニメニュー中操作（小さい原寸画面）

Ｌキー：連射                    Ｒキー：連射
            ____________________________________                
           |FPS: 60 ____________________        |     スタート  
           |       |                    |       |     ｜        
           |       |                    |       |     △        
方向≡方向 |       |  [=- [== [=:  /X   |       | □      ○    
           |       |  ==] [== [[] /  X  |       | ｜  ×  ｜    
           |       |                    |       | ｜  ｜  ｜    
  （＠）   |MENU 99 ~~~~~~~~~~~~~~~~~~~~        | Ａ  Ｂ  Ｃ    
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
[SELECT]キー：ミニメニュー項目切り替え。    [START]キー：値変更。（－１）

■この画面モードは、現状デバッグ用画面になっています。

================================================
□設定画面の説明
config   現在値     default    ロード後の再設定値

「１ｘ」以外でＲＯＭをロードする度に設定値が「default」になります。（現状の仕様）

で、△ボタンで、「default」が書き換えられます。

「画面モード変えたい」とか「ガタガタでも２２０５０じゃなきゃ」とか、そおいう用途。

================================================
■SHOW FPS:（ＦＰＳ表示）
  ＦＰＳの表示（ＯＮ）／非表示（ＯＦＦ）です。
  初期状態は、非表示（ＯＦＦ）です。
「１ｘ」モード時は、デバッグメニューも表示します。

■FLAME SKIPS:（フレームスキップ）
  何コマ飛ばして誤魔化すか。          １２３４５６７８９０１２３４５６７８９０１２３４５
  ０：誤魔化さない。（最大６０ｆｐｓ）描描描描描描描描描描描描描描描描描描描描描描描描描（最高の細かさだが、重過ぎ）
  １：一コマ飛ばし。（最大３０ｆｐｓ）描  描  描  描  描  描  描  描  描  描  描  描  描（ちらつきに弱い）
  ２：二コマ飛ばし。（最大２０ｆｐｓ）描    描    描    描    描    描    描    描    描（殆どのちらつきを再現）
  ３：三コマ飛ばし。（最大１５ｆｐｓ）描      描      描      描      描      描      描
  ４：四コマ飛ばし。（最大１２ｆｐｓ）描        描        描        描        描        
  ５：五コマ飛ばし。（最大１０ｆｐｓ）描          描          描          描          描
  ６：六コマ飛ばし。（最大8.57ｆｐｓ）描            描            描            描      
//７：七コマ飛ばし。（最大 7.5ｆｐｓ）描              描              描              描（現在この設定はない）
//８：八コマ飛ばし。（最大6.66ｆｐｓ）描                描                描            （現在この設定はない）
//９：九コマ飛ばし。（最大  ６ｆｐｓ）描                  描                  描        （現在この設定はない）
//10：10コマ飛ばし。（最大5.45ｆｐｓ）描                    描                    描    （現在この設定はない）
//11：11コマ飛ばし。（最大  ５ｆｐｓ）描                      描                      描（現在この設定はない）
Tips：（最大  Ｘｆｐｓ）のＸは、６０／Ｘで計算できます。
現状で、取りあえず遊ぶんなら７（初期値、「Auto FPS mode」）です。それか２「2 fps (max20)」です。
（それ以外はデバック用）
まだ、このエミュは重いです。ガタガタしてるのは、仕方ありません。
ＦＳＫＩＰ１よりＦＳＫＩＰ２の方が「ちらつき」を駆使したゲームの場合、再現度が高いです。

  初期状態は、「Auto FPS mode」です。

■V-SYNC:
  まだ作ってません。常に無効。

■SCREEN MODE:（画面モード）

  MAX_TOP       上
  MAX_UP        上より
  MAX_MID       真中
  MAX_DOWN      下側
  MAX_BOTTOM    下
  FULL          拡大
  FIT           縦あわせ
  1x            原寸（デバッグ用だが、別に使ってもいい。が操作体系が多少違う）

■AUDIO RATE:（再生周波数）
  サンプリングレート変更。

■FILE FIX MODE:（チェックサム修正）
  初期状態は、非表示（ＯＦＦ）です。
  ＯＮで（ロードしたＲＯＭの）チェックサム修正が出来ます。（がファイルには書き込めない）

■RAPID RATE:（連射レート）
０：不定期連射。
１：業務用シンクロ連射。（初期状態）
２：シンクロ連射２。
    ...
７：シンクロ連射７。

■[RESET]:（リセット）
  問答無用でリセットされます。（単なる、メガドラのリセットスイッチ）

================================================
■ミニメニュー（デバッグメニュー）説明
（ミニメニューは初期状態では非表示です）
表示方法は、
１．設定画面にする。
    「設定でSHOW FPS: ON」
    「設定でSCREEN MODE:1x」
    ゲームに戻ると、ミニメニュー（デバッグメニュー）出現。

２．[SELECT]キーで項目を切り替えます。
    [START]で内容を変えます。

３．画面に「文字のゴミ」が出てる場合は、[SELECT]キーで消せます。

４．[SELECT]キーで「[RESET]」に合わせておくと[START]キーで、
いつでもリセット出来ます。（便利？）

５．「画面モード」をかえると強制的に「メニュー」に戻ります。

================================================
私は現在、コンパイル／ＧＣＣ４．０．０環境です。
（toolchain.shを動かしてないので、ＰＳＰＳＤＫではないです）

現在の主流はＧＣＣ４．０．２の様です。が、４．０．２にする為には、
最低でもtoolchain.shを動かさないと駄目みたい。
toolchain.shの中身は、（ネット経由の）ＳＶＮで自動更新。
サーバーがトロイと（多分ね）果てしなく時間がかかる模様。
下記のような便利なＺＩＰがあると、初心者には楽なんだけどな。

  ■ＰＳＰのＧＣＣ達（ＳＤＫ）
  以下の一連のページはサーバーの都合で落としてきた
  ファイル名が変わっちゃうので逐一修正する事。
  落としてきても（名前を直しておかないと）後で
  訳が判らなくなります。
  http://psp-dev.org/pukiwiki/index.php?ToolChain
    （ツールチェインのページ）
  １．（ＧＣＣ）「psp-gcc-4.0.0.tar.bz2」
  http://psp-dev.org/files/psp-gcc-4.0.0.tar.bz2
     (約１２ＭＢ 12,511,957[bytes])
  ２．（ライブラリ）「psp-newlib-1.13.0-compiled-with-gcc-4.0.0.tar.bz2」
http://psp-dev.org/files/psp-newlib-1.13.0-compiled-with-gcc-4.0.0.tar.bz2
     (約０．８ＭＢ  856,717[bytes])
  ３．（ユーティリティー）「psp-binutils-2.16.tar.bz2」
  http://psp-dev.org/files/psp-binutils-2.16.tar.bz2
  (約４ＭＢ    4,225,299[bytes])
  これらは既に「toolchain」のパッチが当たっています。

「toolchain.sh」を動かして、最新の４．０．２にしたい方は、
多分ここ、http://www.oopo.net/consoledev/
Toolchain Files
[02-22-2006] newtoolchain-20060222.tgz - The new, experimental toolchain autobuild script.
訳：最新の奴でちゅ。
[01-20-2006] psptoolchain-20060120.tgz - The famous pspdev toolchain autobuild script.
訳：有名な奴でちゅ。


■cygwin      （unix互換の環境なら何でもいい）
  注意：ＯＳがlinuxな人には既に関係ない話です。
  注意：Macな人も関係あるらしいです。
  http://cygwin.com/    (Cygwin Projectのページ)
  http://cygwin.com/setup.exe

Ｗ９８な人へ：
うちはＷ９８ＳＥの純正ＩＥ５なので（ボッツだと決め付けられて）跳ねられちゃいます。
ＩＥなら６にしてください。アップデートが嫌ならＯｐｅｒａ辺りがお勧めかも。
  http://www.vector.co.jp/vpack/filearea/win/net/www/index.html
     (ブラウザＩＮＤＥＸ)
  http://www.vector.co.jp/soft/win95/net/se379091.html
    （Ｏｐｅｒａ８．５）
ＩＥ６は標準かどうか知らないが、私は使いにくい。

■補足情報（２００６－０１／１９）
Ｃｙｇｗｉｎでなくても、

ＭｉｎＧＷでも、出来るそうです。（試してないので知らない）
オフィシャルサイトはこちら、
http://www.mingw.org/
================================================
「unziplib.a」の公式ソースリストが欲しい場合は、
ＲＵＫＡさんの公式ページからどおぞ。
http://rukapsp.hp.infoseek.co.jp/
http://rukapsp.hp.infoseek.co.jp/PSPSoftware/archive/unziplib_v1_00src.zip
(2005-06/11版)
（外国のサイトからでも落とせます。例えばＰＳＰ－ＡＲＣＨＩＶＥとか）
================================================
■make方法。「make maketree↓」「make↓」
■ソースについて。うちは４タブです。
■遊ぶだけじゃなくて、ソースコンパイルして欲しいなぁ、出来れば。
その為だけに、うちは態々４．０．２や「ＰＳＰＳＤＫ」にしないんだから。
誰もコンパイルしないなら、とっとと４．０．２にしちゃうよお。
（他人が再現できない環境にしたくない）
================================================
